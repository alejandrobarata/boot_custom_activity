// prettier-ignore
define(function(t){var e=new(t("postmonger").Session),n={},o="",a=[{label:"Canal",key:"step1"},{label:"C贸digo plantilla",key:"step2"},{label:"Info",key:"step3"}],i=a[0].key,u="",l="",r=new Map;function c(t,n){switch(n&&!t&&(t=a[n-1]),i=t,$(".step").hide(),i.key){case"step1":$("#step1").show(),e.trigger("updateButton",{button:"next",enabled:Boolean(g("canal"))}),e.trigger("updateButton",{button:"back",visible:!1});break;case"step2":$("#step2").show(),e.trigger("updateButton",{button:"back",visible:!0}),e.trigger("updateButton",{button:"next",text:"next",visible:!0,enabled:Boolean(g("codigo"))});break;case"step3":$("#step3").show(),e.trigger("updateButton",{button:"back",visible:!0}),e.trigger("updateButton",{button:"next",text:"done",visible:!0})}}function g(t){return $("#"+t).find("option:selected").attr("value").trim()}$(window).ready(function(){e.trigger("ready"),e.trigger("requestInteraction"),$("#canal").change(function(){u=g("canal"),e.trigger("updateButton",{button:"next",enabled:Boolean(u)}),""!=u?function(t,e){var n='<option value="">--</option>';if(r.has(e)){for(var[o,a]of r.get(e))n+='<option value="'+o+'">'+a+"</option>";$("#"+t).html(n)}}("codigo",u):$("#codigo").html('<option value="">--</option>'),$("#canalTexto").html(u)}),$("#codigo").change(function(){l=g("codigo"),e.trigger("updateButton",{button:"next",enabled:Boolean(u)}),$("#codigoTexto").html(l)})}),e.on("initActivity",function(t){t&&(n=t);var o=Boolean(n.arguments&&n.arguments.execute&&n.arguments.execute.inArguments&&n.arguments.execute.inArguments.length>0)?n.arguments.execute.inArguments:{};$.each(o,function(t,e){$.each(e,function(t,e){"canal"===t&&(u=e),"codigoPlantilla"===t&&(l=e)})}),a="canal",i=u,g="",$.getJSON("data.json",function(t){g+='<option value="">--</option>',$.each(t,function(t,e){"0"==e.parent_id?(r.set(e.id,new Map),g+='<option value="'+e.id+'">'+e.name+"</option>"):r.get(e.parent_id).set(e.id,e.name)}),$("#"+a).html(g),i&&($("#"+a).find("option[value="+i+"]").attr("selected","selected"),$("#"+a).trigger("change"))}),u&&l?($("#canalTexto").html(u),$("#codigoTexto").html(l),c(null,3)):(c(null,1),e.trigger("updateButton",{button:"next",enabled:!1}));var a,i,g}),e.on("requestedTokens",function(t){}),e.on("requestedEndpoints",function(t){}),e.on("clickedNext",function(){"step3"===i.key?(t=$("#canal").find("option:selected").html(),n.name=t,n.arguments.execute.inArguments=[{canal:u},{codigoPlantilla:l},{emailAddress:"{{InteractionDefaults.Email}}"},{codigoPostal:"{{Event."+o+'."CodigoPostal"}}'}],console.log(n.outcomes),n.outcomes=[{arguments:{branchResult:"true"},metaData:{label:"True c贸digo postal"}},{arguments:{branchResult:"false"},metaData:{label:"False c贸digo postal"}},{arguments:{branchResult:"0"},metaData:{label:"0 c贸digo postal"}}],n.metaData.isConfigured=!0,e.trigger("updateActivity",n)):e.trigger("nextStep");var t}),e.on("clickedBack",function(){e.trigger("prevStep")}),e.on("gotoStep",function(t){c(t),e.trigger("ready")}),e.on("requestedInteraction",function(t){o=t.triggers[0].metaData.eventDefinitionKey})});
